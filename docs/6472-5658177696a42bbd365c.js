"use strict";(self.webpackChunkembla_carousel_docs=self.webpackChunkembla_carousel_docs||[]).push([[6472],{6472:function(e,n,o){o.r(n),n.default="import {\n  EmblaCarouselType,\n  EmblaEventListType,\n  EmblaEventModelType\n} from 'embla-carousel'\n\nexport const setupLazyLoadImage = <EventType extends keyof EmblaEventListType>(\n  emblaApi: EmblaCarouselType\n): ((\n  emblaApi: EmblaCarouselType,\n  event?: EmblaEventModelType<EventType>\n) => void) => {\n  const imagesInView: number[] = []\n  const slideNodes = emblaApi.slideNodes()\n  const spinnerNodes = slideNodes.map(\n    (slideNode) =>\n      <HTMLElement>slideNode.querySelector('.embla__lazy-load__spinner')\n  )\n  const imageNodes = slideNodes.map(\n    (slideNode) =>\n      <HTMLImageElement>slideNode.querySelector('.embla__lazy-load__img')\n  )\n\n  const loadImageInView = (index: number): void => {\n    const imageNode = imageNodes[index]\n    const slideNode = slideNodes[index]\n    const spinnerNode = spinnerNodes[index]\n    const src = <string>imageNode.getAttribute('data-src')\n\n    imageNode.src = src\n    imagesInView.push(index)\n\n    const onLoad = (): void => {\n      slideNode.classList.add('embla__lazy-load--has-loaded')\n      spinnerNode.parentElement?.removeChild(spinnerNode)\n      imageNode.removeEventListener('load', onLoad)\n    }\n    imageNode.addEventListener('load', onLoad)\n  }\n\n  const loadImagesInView = (): boolean => {\n    emblaApi\n      .slidesInView()\n      .filter((index) => !imagesInView.includes(index))\n      .forEach(loadImageInView)\n    return imagesInView.length === imageNodes.length\n  }\n\n  const loadImagesInViewAndDestroyIfDone = <\n    EventType extends keyof EmblaEventListType\n  >(\n    emblaApi: EmblaCarouselType,\n    event?: EmblaEventModelType<EventType>\n  ): void => {\n    const hasLoadedAll = loadImagesInView()\n\n    if (hasLoadedAll && event) {\n      emblaApi.off(event.type, loadImagesInViewAndDestroyIfDone)\n    }\n  }\n\n  return loadImagesInViewAndDestroyIfDone\n}\n"}}]);
//# sourceMappingURL=6472-5658177696a42bbd365c.js.map